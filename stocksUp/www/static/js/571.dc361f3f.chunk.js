"use strict";(self.webpackChunkstocksup=self.webpackChunkstocksup||[]).push([[571],{8571:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var o=s(2791),c=s(184);const a=e=>{let{items:t}=e;const[s,a]=(0,o.useState)(0);return(0,c.jsxs)("div",{className:"buy-page-carousel",children:[(0,c.jsx)("div",{className:"carousel-left",onClick:()=>{a((e=>0===e?t.length-1:e-1))},children:(0,c.jsx)("i",{class:"fas fa-arrow-left"})}),t[s],(0,c.jsx)("div",{className:"carousel-right",onClick:()=>{a((e=>(e+1)%t.length))},children:(0,c.jsx)("i",{class:"fas fa-arrow-right"})})]})};var l=s(7689),n=s(4420),i=s(4700),r=s(5294),d=s(3623),u=s(3197),f=s(550),g=s(8886);f.kL.register(g.uw);const h=e=>{let{portfolio_id:t,socket:s}=e;const[a,l]=(0,o.useState)([]),[n,i]=(0,o.useState)([]);(0,o.useEffect)((()=>{r.Z.post("".concat(u.L,"/portfolios/data/line-chart"),{portfolio_id:t}).then((e=>{let{data:t}=e;l(t.x),i(t.lineData)}))}),[]),(0,o.useEffect)((()=>(s.on("line-chart-data",(e=>{const t=new Date(Date.now()),s="".concat(t.getHours(),":").concat(t.getMinutes());let o=new Date("2024-02-01 ".concat(s)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});l((t=>o==t[t.length-1]?(i((t=>{let s=[...t];return s[s.length-1]=e,s})),[...t]):(i((t=>[...t,e])),[...t,o])))})),()=>{})),[]);return(0,c.jsx)("div",{className:"line-chart",children:(0,c.jsx)(d.x1,{datasetIdKey:"id",data:{labels:a,datasets:[{id:1,label:"",data:n}]},options:{scales:{x:{grid:{color:"#ddea11"},ticks:{color:"#dddddd"}},y:{grid:{color:"#dddddd"},ticks:{color:"#dddddd"}}}}})})};var p=s(7719),m=s(1608),k=s(5005);let x,y;const S=()=>{const{id:e}=(0,l.UO)(),t=(0,l.s0)(),s=(0,n.I0)(),r=(0,n.v9)((e=>e.portfolio)),[d,f]=(0,o.useState)(),[g,S]=(0,o.useState)(),[j,v]=(0,o.useState)(),[b,_]=(0,o.useState)(),[w,I]=(0,o.useState)(),[N,L]=(0,o.useState)(0);let[E,C]=(0,o.useState)([]);const[D,A]=(0,k.a)(),O=()=>(0,c.jsx)("p",{style:{textAlign:"center"},children:g});(0,o.useEffect)((()=>{s((0,i.x)())}),[s]);const P=(0,o.useRef)("");return(0,o.useEffect)((()=>(x=(0,m.io)(u.L),console.log("useeffect"),y=localStorage.getItem("icell_pitcher_userId"),y=localStorage.getItem("icell_pitcher_userId")?JSON.parse(localStorage.getItem("icell_pitcher_userId")):null,console.log(y),x.on("connect",(()=>{console.log("Socket is connected (frontend)")})),x.emit("join-room",e),x.emit("getStock",e,y,(e=>{I(e[0]),L(e[1])})),x.on("show-stock",(e=>{I(e[0]),L(e[1])})),x.on("userStock-empty",(()=>{(0,p.lL)("Dont have enough Stock ")})),x.on("stock-empty",(()=>{(0,p.lL)("stock empty")})),x.on("successfully-purchased",(e=>{(0,p.RT)("Successfully Purchased ".concat(e," stocks")),A((e=>!e))})),x.on("disconnect",(function(){console.log("Got disconnect!"),t("/Portfolio")})),C([(0,c.jsx)(h,{portfolio_id:e,socket:x}),O()]),()=>{console.log("socket disconnecg"),x.disconnect()})),[]),(0,o.useEffect)((()=>{if(r&&r.length>0)for(var t=r[0],s=0;s<t.length;s++)if(t[s]._id===e){f(t[s]),v(t[s].name),S(t[s].about),_(t[s].leader),I(t[s].stock);break}}),[e]),(0,o.useEffect)((()=>{C([(0,c.jsx)(h,{portfolio_id:e,socket:x}),O()])}),[g]),(0,c.jsxs)("div",{className:"buy-page",children:[(0,c.jsxs)("div",{className:"buy-page-details",children:[(0,c.jsx)("h2",{children:j}),(0,c.jsx)(a,{items:E})]}),(0,c.jsxs)("div",{className:"buy-page-input",children:[(0,c.jsx)("p",{children:(0,c.jsx)("input",{type:"number",placeholder:"Enter Amount / ".concat(w),className:"buy-amount",ref:P})}),(0,c.jsx)("button",{onClick:()=>{let t=P.current.value;!t||t<=0?(0,p.lL)("Invalid Input"):(x.volatile.emit("buy",e,y,t),P.current.value="")},children:"Buy"})]})]})}},4700:(e,t,s)=>{s.d(t,{x:()=>n});var o=s(640),c=s(5294),a=s(3197);const l="".concat(a.L,"/portfolios"),n=()=>async e=>{try{const{data:t}=await c.Z.get(l);e({type:o.d,payload:t})}catch(t){console.log(t.message)}}}}]);
//# sourceMappingURL=571.dc361f3f.chunk.js.map